# Jest でuseEffect のテストを行う
けっこうハマってしまい、いろいろ試したので詳細を覚えていない...ざっくり書いておく  

- モジュールのインポート方式の問題（ES Module か CommonJS か）によって、axios がうまく使えなかった
- jest がESMに(標準では)対応していないらしい
- jest が持っているaxios のモック関数を使うなどで対処できるかも、と思ったが、今回は実際にaxiosを利用したテストを行ってみたいので見送り

- jestのESM対応の方法を調べてみる
- 設定ファイルをいろいろ変更することでできるようだが、ドキュメントがうまく探せず断念
- モジュールのトランスフォーム？を行う際に、ts-moduleではなく別のパッケージを利用することで対応できそう

- esbuild-jest と swc の2つが候補として見つかった
- まずesbuild-jest を導入してみた
- 設定を行ってみたが、よくわからないエラーが発生してしまい対処できず。
  - 詳細覚えていないが、 esbuild-jest のパッケージにjest-preset.js(基本設定ファイル)が必要だ、みたいな内容だった
	- ts-jest のパッケージにはあったが、たしかにesbuild-jest のパッケージにはそれらしいものがなかった

- swc を導入
- 設定ファイルを直してみたら、特にエラーなどにもならず動作した
- テストの実行速度も確かに早くなったよう(５秒くらいだったのが１秒前後まで短縮)
- 一方、暗黙的なインポートがされなくなってしまったよう
  - テスト実行時に、`React がインポートされてない` のようなエラーが表示されるようになった
	- ふつうにインポートを書けば問題ない
	- 記載したのは `React`, `jest-dom (findByTestId() とか)`, `@jest/globals (jest.fn() とか)` あたり
